<!doctype html>
<html lang="en">
<head>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-WWMJ10RDX7"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-WWMJ10RDX7');
  </script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Blueandplay Media Capture Tool</title>

  <link rel="manifest" href="./manifest.json">
  <meta name="theme-color" content="#00bfa5">
  <link rel="apple-touch-icon" href="./icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <style>
    :root {
      --bg: #0f172a;
      --accent: #00bfa5;
      --text: #e2e8f0;
      --muted: #94a3b8;
    }
    body {
      margin: 0;
      font-family: system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    h1 { color: var(--accent); }
    video, canvas {
      width: 100%;
      max-width: 480px;
      border-radius: 8px;
      background: #000;
    }
    button {
      margin: 6px;
      padding: 10px 14px;
      border-radius: 6px;
      border: none;
      background: var(--accent);
      font-weight: 600;
      cursor: pointer;
    }
  </style>
</head>
<body>

<h1>ðŸ“¸ Yenner's Media Capture Tool</h1>
<video id="preview" autoplay muted playsinline></video>
<canvas id="canvas" style="display:none;"></canvas>

<div>
  <button id="startCam">Start Camera</button>
  <button id="takePhoto">Take Photo</button>
  <button id="startRec">Start Recording</button>
  <button id="stopRec">Stop Recording</button>
</div>

<div id="downloads"></div>

<script>
let stream, recorder, chunks = [];
const preview = document.getElementById("preview");
const canvas = document.getElementById("canvas");
const downloads = document.getElementById("downloads");

document.getElementById("startCam").onclick = async () => {
  stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
  preview.srcObject = stream;
};

document.getElementById("takePhoto").onclick = () => {
  canvas.width = preview.videoWidth;
  canvas.height = preview.videoHeight;
  canvas.getContext("2d").drawImage(preview, 0, 0);
  canvas.toBlob(blob => {
    const url = URL.createObjectURL(blob);
    downloads.innerHTML = `<a href="${url}" download="Playblueandplay.png">Download Photo</a>`;
  });
};

document.getElementById("startRec").onclick = () => {
  chunks = [];
  recorder = new MediaRecorder(stream);
  recorder.ondataavailable = e => chunks.push(e.data);
  recorder.onstop = () => {
    const blob = new Blob(chunks, { type: "video/webm" });
    const url = URL.createObjectURL(blob);
    downloads.innerHTML = `<video controls src="${url}"></video><a href="${url}" download="UseYennerOnlineGNET.webm">Download Video</a>`;
  };
  recorder.start();
};

document.getElementById("stopRec").onclick = () => recorder?.stop();

if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("./service-worker.js");
}
</script>

</body>
</html>
